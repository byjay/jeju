<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê°•ê·€ì„ ë‹˜ì„ ìœ„í•œ ì œì£¼ì—¬í–‰ í”Œë˜ë„ˆ - BY BONG</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAOAEMIvJc9VndXLYgmUnWoAuXjlOYzDtg&callback=initApp&libraries=places,directions&v=weekly" defer></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700;900&display=swap');
        * { font-family: 'Noto Sans KR', sans-serif; }
        :root { --primary-blue: #3b82f6; --primary-purple: #7c3aed; --success-green: #10b981; --gray-800: #1f2937; }
        html { scroll-behavior: smooth; }
        body { background-color: #f3f4f6; }
        .main-container { max-width: 1400px; margin: 0 auto; background-color: white; }
        .header-gradient { background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-purple) 100%); }
        
        /* Sticky & Fixed Headers for Mobile */
        @media (max-width: 1023px) {
            body { padding-top: calc(25vh + 60px); } /* Map height + Tab height */
            #map-wrapper { position: fixed; top: 0; left: 0; right: 0; height: 25vh; z-index: 1000; }
            .day-tab-container-wrapper { position: fixed; top: 25vh; left: 0; right: 0; z-index: 900; }
        }

        /* Sticky Header for Desktop */
        @media (min-width: 1024px) {
            .day-tab-container-wrapper { position: sticky; top: 0; }
            #map-wrapper { position: sticky; top: 1rem; height: 450px; }
        }
        
        .day-tab-container-wrapper { background-color: white; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); }
        .day-tab { transition: all 0.3s ease; border-bottom: 4px solid transparent; }
        .day-tab.active { border-bottom-color: var(--primary-blue); color: var(--primary-blue); font-weight: 700; }
        
        /* Option Bar & Details Panel */
        .option-container { margin-bottom: 0.5rem; }
        .option-bar {
            display: flex; align-items: center; padding: 0.8rem 1rem; border: 1px solid #e5e7eb; border-radius: 12px;
            cursor: pointer; transition: all 0.2s ease-in-out; background-color: white; width: 100%;
        }
        .option-bar:hover { border-color: var(--primary-blue); transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.08); }
        .option-bar.selected {
            background: linear-gradient(135deg, #eff6ff 0%, #f5f3ff 100%); border-color: var(--primary-blue);
            box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2); border-bottom-left-radius: 0; border-bottom-right-radius: 0;
        }
        .option-icon { font-size: 1.3rem; width: 2.2rem; text-align: center; }
        .option-name { font-weight: 700; flex-grow: 1; margin: 0 0.75rem; color: #374151; }
        .rating-box { display: flex; align-items: center; color: #f59e0b; font-weight: 700; }
        
        .details-panel {
            max-height: 0; overflow: hidden; transition: max-height 0.4s ease-out, padding 0.4s ease-out, border 0.4s ease-out;
            background: #f8fafc; border-radius: 0 0 12px 12px; border: 1px solid transparent; padding: 0 1.25rem;
        }
        .details-panel.open { max-height: 600px; padding: 1.25rem; border-color: #e5e7eb; border-top: none; }
        .details-tabs { display: flex; border-bottom: 2px solid #e2e8f0; margin-bottom: 1rem; }
        .details-tab { padding: 0.5rem 1rem; cursor: pointer; font-weight: 600; color: #6b7280; border-bottom: 3px solid transparent; }
        .details-tab.active { color: var(--primary-blue); border-bottom-color: var(--primary-blue); }
        .details-content { display: none; }
        .details-content.active { display: block; animation: fadeIn 0.5s; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* Map & Other Elements */
        #map { height: 100%; width: 100%; }
        @media (min-width: 1024px) { #map { border-radius: 12px; } }
        
        #bottom-nav {
            position: fixed; bottom: -100px; left: 0; right: 0; z-index: 1000; transition: transform 0.4s ease-in-out;
            background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
        }
        #bottom-nav.visible { transform: translateY(-100px); }
        
        .gm-style .gm-style-iw-c { padding: 0 !important; border-radius: 12px !important; box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;}
        .gm-style-iw-d { overflow: hidden !important; }
        .info-window-content { padding: 1rem; max-width: 280px; }
        .info-window-content h3 { font-size: 1.1rem; font-weight: 700; margin-bottom: 0.5rem; color: #111827; }
        .info-window-content .rating { color: #f59e0b; font-weight: bold; margin-bottom: 0.5rem; }
        .info-window-content .menu-item { display: flex; justify-content: space-between; font-size: 0.85rem; padding: 0.3rem 0; border-bottom: 1px dashed #e5e7eb;}
        .info-window-content .menu-title { font-weight: 600; margin-top: 0.75rem; margin-bottom: 0.25rem; color: #4b5563; }
    </style>
</head>
<body class="bg-gray-100">
    <div class="main-container">
        <div class="header-gradient text-white p-6 text-center">
            <h1 class="text-3xl md:text-4xl font-black mb-2">ê°•ê·€ì„ ë‹˜ ë§ì¶¤ ì œì£¼ì—¬í–‰</h1>
            <p class="text-lg md:text-xl opacity-90">ì‹¤ì‹œê°„ ë™ì„  ìµœì í™” í”Œë˜ë„ˆ-BY BONG</p>
        </div>
        <div class="p-2 md:p-6 grid grid-cols-1 lg:grid-cols-3 gap-6">
            <div class="lg:col-span-2">
                <div class="bg-white rounded-xl p-4 mb-4 shadow-md">
                    <h3 class="font-bold text-lg mb-3 flex items-center"><i class="fas fa-map-signs mr-2 text-blue-500"></i>#í…Œë§ˆë¡œ ì¥ì†Œ ì°¾ê¸°</h3>
                    <div class="grid grid-cols-3 md:grid-cols-6 gap-2">
                        <button onclick="searchByTheme('restaurant')" class="theme-btn bg-red-100 text-red-700 hover:bg-red-200 p-2 rounded-lg font-semibold transition">ğŸ½ï¸ ë§›ì§‘</button>
                        <button onclick="searchByTheme('cafe')" class="theme-btn bg-yellow-100 text-yellow-700 hover:bg-yellow-200 p-2 rounded-lg font-semibold transition">â˜• ì¹´í˜</button>
                        <button onclick="searchByTheme('tourist_attraction')" class="theme-btn bg-green-100 text-green-700 hover:bg-green-200 p-2 rounded-lg font-semibold transition">ğŸï¸ ê´€ê´‘ì§€</button>
                        <button onclick="searchByTheme('beach')" class="theme-btn bg-blue-100 text-blue-700 hover:bg-blue-200 p-2 rounded-lg font-semibold transition">ğŸ–ï¸ í•´ë³€</button>
                        <button onclick="searchByTheme('shopping')" class="theme-btn bg-purple-100 text-purple-700 hover:bg-purple-200 p-2 rounded-lg font-semibold transition">ğŸ›ï¸ ì‡¼í•‘</button>
                        <button onclick="searchByTheme('activity')" class="theme-btn bg-pink-100 text-pink-700 hover:bg-pink-200 p-2 rounded-lg font-semibold transition">ğŸª ì²´í—˜</button>
                    </div>
                </div>
                <div class="day-tab-container-wrapper">
                    <div id="day-tabs-container" class="flex justify-around p-2"></div>
                </div>
                <div id="itinerary-container" class="mt-4"></div>
            </div>
            <div class="lg:col-span-1">
                <div id="map-wrapper"><div id="map"></div></div>
                <div class="hidden lg:block space-y-6 mt-6">
                    <div class="bg-white rounded-xl shadow-md">
                        <div class="p-4 font-bold border-b"><i class="fas fa-list-check mr-2 text-green-500"></i>ì˜¤ëŠ˜ì˜ ì—¬í–‰ ê³„íš</div>
                        <div id="selected-items-container" class="p-4 max-h-80 overflow-y-auto"></div>
                    </div>
                    <div class="bg-white rounded-xl shadow-md">
                        <div class="p-4 font-bold border-b"><i class="fas fa-calculator mr-2 text-purple-500"></i>ì—¬í–‰ ê²½ë¹„</div>
                        <div class="p-4 space-y-4" id="cost-calculator"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="bottom-nav" class="p-3 border-t border-gray-200 flex justify-between items-center">
        <button id="prev-day-btn" class="font-bold text-gray-700 py-2 px-4 rounded-lg flex items-center transition hover:bg-gray-200 disabled:opacity-50 disabled:hover:bg-transparent"><i class="fas fa-chevron-left mr-2"></i> ì´ì „ë‚ </button>
        <div class="text-lg font-black text-blue-600"><span id="bottom-nav-day">1</span>ì¼ì°¨</div>
        <button id="next-day-btn" class="font-bold text-gray-700 py-2 px-4 rounded-lg flex items-center transition hover:bg-gray-200 disabled:opacity-50 disabled:hover:bg-transparent">ë‹¤ìŒë‚  <i class="fas fa-chevron-right ml-2"></i></button>
    </div>

<script>
const jejuDatabase = { 
    arrival: { id: 'arrival', name: 'ì œì£¼êµ­ì œê³µí•­ ë„ì°©', cost: 0, type: 'etc', tags: ['í•„ìˆ˜'], lat: 33.5104, lng: 126.4913, menu:[], reviews:[]},
    airport_stay: { id: 'airport_stay', name: 'ê³µí•­ ê·¼ì²˜ ìˆ™ì†Œ', cost: 150000, type: 'accommodation', tags: ['ìˆ™ì†Œ'], lat: 33.508, lng: 126.5 },
    jamaeguksu: { id: 'jamaeguksu', name: 'ìë§¤êµ­ìˆ˜', rating: 4.1, reviewCount: 3891, cost: 35000, type: 'food', icon: 'ğŸœ', lat: 33.5074, lng: 126.5284, tags: ['ê³ ê¸°êµ­ìˆ˜', 'í–¥í† ìŒì‹'], menu: [{item:'ê³ ê¸°êµ­ìˆ˜',price:9000},{item:'ë¹„ë¹”êµ­ìˆ˜',price:9000}], reviews: [{author:'ë©´ì¹˜ê¸°', rating:4, text:'ì§„í•œ êµ­ë¬¼ë§›ì´ ì¼í’ˆ. ì›¨ì´íŒ…ì€ ê¸°ë³¸ì´ì—ìš”.'}] },
    dombedon: { id: 'dombedon', name: 'ë”ë² ëˆ', rating: 4.3, reviewCount: 2247, cost: 130000, type: 'food', icon: 'ğŸ–', lat: 33.5148, lng: 126.5245, tags: ['í‘ë¼ì§€', 'ê·¼ê³ ê¸°'], menu: [{item:'í‘ë¼ì§€2ì¸',price:69000},{item:'ê¹€ì¹˜ì°Œê°œ',price:8000}], reviews: [{author:'ê³ ê¸°ì‚¬ë‘', rating:5, text:'ìœ¡ì¦™ ê°€ë“í•œ í‘ë¼ì§€ë¥¼ ì§ì›ë¶„ì´ ë§›ìˆê²Œ êµ¬ì›Œì¤˜ì„œ í¸í•´ìš”.'}] },
    dongmun_market: { id: 'dongmun_market', name: 'ë™ë¬¸ì‹œì¥ ì•¼ì‹œì¥', rating: 4.2, reviewCount: 4500, cost: 50000, type: 'food', icon: 'ğŸ¦', lat: 33.5126, lng: 126.5292, tags: ['ì•¼ì‹œì¥', 'ê¸¸ê±°ë¦¬ìŒì‹'], menu: [{item:'ëìŠ¤í„°êµ¬ì´',price:15000},{item:'í‘ë¼ì§€ì˜¤ê²¹ë§ì´',price:8000}], reviews: [{author:'ì•¼ì‹ì™•', rating:4, text:'í™œê¸°ì°¨ê³  ë¨¹ì„ê²Œ ë§ì•„ìš”. ì‚¬ëŒ ë§ì€ ê±´ ê°ìˆ˜í•´ì•¼ í•´ìš”.'}] },
    samsunghyeol: { id: 'samsunghyeol', name: 'ì‚¼ì„±í˜ˆ í•´ë¬¼íƒ•', rating: 4.3, reviewCount: 1200, cost: 90000, type: 'food', icon: 'ğŸ¦€', lat: 33.5090, lng: 126.5286, tags: ['í•´ë¬¼íƒ•', 'ê°€ì¡±ì‹ì‚¬'], menu: [{item:'í•´ë¬¼íƒ•(ì†Œ)',price:60000},{item:'ì „ë³µëšë°°ê¸°',price:15000}], reviews: [{author:'êµ­ë¬¼íŒŒ', rating:4, text:'ì‚´ì•„ìˆëŠ” ë¬¸ì–´ì™€ ì „ë³µ! í•´ë¬¼ì´ ì‹ ì„ í•˜ê³  í‘¸ì§í•´ì„œ ì¢‹ì•„ìš”.'}] },
    ujin_haejang: { id: 'ujin_haejang', name: 'ìš°ì§„í•´ì¥êµ­', rating: 4.2, reviewCount: 3300, cost: 30000, type: 'food', icon: 'ğŸ²', lat: 33.5142, lng: 126.5226, tags: ['ê³ ì‚¬ë¦¬í•´ì¥êµ­', 'ëª¸êµ­'], menu: [{item:'ê³ ì‚¬ë¦¬ìœ¡ê°œì¥',price:10000},{item:'ëª¸êµ­',price:10000}], reviews: [{author:'í•´ì¥ì¸', rating:4, text:'ì²˜ìŒì—” ì´ê²Œ ë¬´ìŠ¨ ë§›ì¸ê°€ ì‹¶ì€ë°, ê³„ì† ìƒê°ë‚˜ëŠ” ì¤‘ë…ì„± ê°•í•œ ë§›.'}] },
    abebe_bakery: { id: 'abebe_bakery', name: 'ì•„ë² ë²  ë² ì´ì»¤ë¦¬', rating: 4.6, reviewCount: 1500, cost: 20000, type: 'cafe', icon: 'ğŸ¥¯', lat: 33.5122, lng: 126.5281, tags: ['í¬ë¦¼ë¹µ', 'ë””ì €íŠ¸', 'ì„ ë¬¼'], menu: [{item:'ìš°ë„ë•…ì½©í¬ë¦¼ë¹µ',price:3500},{item:'ì œì£¼ë…¹ì°¨í¬ë¦¼ë¹µ',price:3500}], reviews: [{author:'ë¹µìˆœì´', rating:5, text:'í¬ë¦¼ì´ ìƒìƒ ì´ìƒìœ¼ë¡œ ê°€ë“í•˜ê³  ì¢…ë¥˜ê°€ ì •ë§ ë‹¤ì–‘í•´ìš”.'}] },
    yongduam: { id: 'yongduam', name: 'ìš©ë‘ì•”&ìš©ì—°êµ¬ë¦„ë‹¤ë¦¬', rating: 4.1, reviewCount: 2100, cost: 0, type: 'activity', icon: 'ğŸŒ‰', lat: 33.5153, lng: 126.5219, tags: ['ì•¼ê²½', 'ì‚°ì±…', 'ë¬´ë£Œ'], menu:[], reviews: [{author:'ì‚°ì±…ëŸ¬', rating:4, text:'ê³µí•­ì—ì„œ ê°€ê¹ê³  ë°¤ì— ì¡°ëª… ì¼œì§€ë©´ ì˜ˆë»ìš”. ê°€ë³ê²Œ ì‚°ì±…í•˜ê¸° ì¢‹ì•„ìš”.'}] },
    iho_tewoo: { id: 'iho_tewoo', name: 'ì´í˜¸í…Œìš° í•´ë³€', rating: 4.3, reviewCount: 1800, cost: 0, type: 'activity', icon: 'ğŸ´', lat: 33.5127, lng: 126.4528, tags: ['ë§ë“±ëŒ€', 'ë…¸ì„', 'ê³µí•­ê·¼ì²˜'], menu:[], reviews: [{author:'ì‚¬ì§„ê°€', rating:4, text:'ë§ ë“±ëŒ€ì™€ í•¨ê»˜ë³´ëŠ” ì¼ëª° í’ê²½ì´ ì •ë§ í™˜ìƒì ì´ì—ìš”. ì¸ìƒìƒ· ëª…ì†Œ.'}] },
    chagwido_stay: { id: 'chagwido_stay', name: 'ì„œìª½(ì°¨ê·€ë„) ìˆ™ì†Œ', cost: 180000, type: 'accommodation', tags: ['ìˆ™ì†Œ'], lat: 33.3857, lng: 126.2104 },
    aewol_noraba: { id: 'aewol_noraba', name: 'ë…¸ë¼ë°”', rating: 4.4, reviewCount: 3210, cost: 50000, type: 'food', icon: 'ğŸœ', lat: 33.4752, lng: 126.3421, tags: ['í•´ë¬¼ë¼ë©´', 'ì˜¤ì…˜ë·°'], menu: [{item:'í•´ë¬¼ë¼ë©´',price:12000},{item:'ë¬¸ì–´ë¼ë©´',price:15000}], reviews: [{author:'ë©´ì¹˜ê¸°', rating:5, text:'ë°”ë‹¤ ë³´ë©´ì„œ ë¨¹ëŠ” ë¼ë©´ì€ ì§„ë¦¬. í•´ë¬¼ì´ ì •ë§ ì‹±ì‹±í•´ìš”.'}] },
    aewol_dwaeji: { id: 'aewol_dwaeji', name: 'ì• ì›” ê·¸ë•Œê·¸ì§‘', rating: 4.5, reviewCount: 1888, cost: 120000, type: 'food', icon: 'ğŸ–', lat: 33.4630, lng: 126.3150, tags: ['í‘ë¼ì§€', 'ì´ˆë²Œêµ¬ì´'], menu: [{item:'í‘ë¼ì§€ê·¼ê³ ê¸°',price:69000},{item:'ê¹€ì¹˜ì°Œê°œ',price:8000}], reviews: [{author:'ìœ¡ì‹ë§¨', rating:5, text:'ì§ì›ë¶„ì´ ë‹¤ êµ¬ì›Œì¤˜ì„œ í¸í•˜ê³  ê³ ê¸° ì§ˆì´ ì •ë§ ì¢‹ì•„ìš”.'}] },
    hallim_suudong: { id: 'hallim_suudong', name: 'ìˆ˜ìš°ë™', rating: 4.4, reviewCount: 1987, cost: 60000, type: 'food', icon: 'ğŸ˜', lat: 33.3934, lng: 126.2346, tags: ['ëˆê¹ŒìŠ¤', 'ìš°ë™', 'ì˜ˆì•½í•„ìˆ˜'], menu: [{item:'ì¼ì‹ëˆì¹´ì¸ ',price:14000},{item:'ìì‘ëƒ‰ìš°ë™',price:12000}], reviews: [{author:'ì¼ì‹ë§¤ë‹ˆì•„', rating:5, text:'ì¸ìƒ ëˆê¹ŒìŠ¤ ë“±ê·¹. ì˜ˆì•½ì´ í˜ë“¤ì§€ë§Œ ê·¸ë§Œí•œ ê°€ì¹˜ê°€ ì¶©ë¶„í•©ë‹ˆë‹¤.'}] },
    jejidona: { id: 'jejidona', name: 'ì œì£¼ëˆì•„', rating: 4.6, reviewCount: 650, cost: 100000, type: 'food', icon: 'ğŸ–', lat: 33.3929, lng: 126.2422, tags: ['í‘ë¼ì§€', 'ì—°íƒ„êµ¬ì´'], menu:[{item:'í‘ë¼ì§€ê·¼ê³ ê¸°', price:65000},{item:'ëœì¥ì°Œê°œ',price:3000}], reviews:[{author:'ê³ ê¸°ë°•ì‚¬', rating:5, text:'ì—°íƒ„ë¶ˆì— êµ¬ì›Œë¨¹ëŠ” í‘ë¼ì§€ ë§›ì´ ê¸°ê°€ ë§‰í™ë‹ˆë‹¤.'}] },
    chagwido_budu: { id: 'chagwido_budu', name: 'ë¶€ë‘ì‹ë‹¹', rating: 4.3, reviewCount: 680, cost: 70000, type: 'food', icon: 'ğŸŸ', lat: 33.3079, lng: 126.1636, tags: ['ê³ ë“±ì–´íšŒ', 'ì°¨ê·€ë„ë§›ì§‘'], menu:[{item:'ê³ ë“±ì–´íšŒ(ì†Œ)', price:40000},{item:'ë§¤ìš´íƒ•',price:15000}], reviews: [{author:'íšŒë°•ì‚¬', rating:5, text:'ì°¨ê·€ë„ í¬êµ¬ ë°”ë¡œ ì•. ì‹±ì‹±í•œ ê³ ë“±ì–´íšŒë¥¼ ë§›ë³¼ ìˆ˜ ìˆëŠ” ê³³.'}] },
    aewol_monsant: { id: 'aewol_monsant', name: 'ëª½ìƒë“œì• ì›”', rating: 4.1, reviewCount: 2540, cost: 35000, type: 'cafe', icon: 'ğŸŒ…', lat: 33.4638, lng: 126.3106, tags: ['ì˜¤ì…˜ë·°', 'GDì¹´í˜', 'í¬í† ì¡´'], menu: [{item:'ì•„ë©”ë¦¬ì¹´ë…¸',price:7000},{item:'í•œë¼ë´‰ì—ì´ë“œ',price:8500}], reviews: [{author:'ì¸ìŠ¤íƒ€', rating:4, text:'ë·°ëŠ” ì •ë§ ìµœê³ . ì»¤í”¼ê°’ì€ ë¹„ì‹¸ì§€ë§Œ ìë¦¬ê°’ì´ë¼ ìƒê°í•˜ë©´ ê´œì°®ì•„ìš”.'}] },
    aewol_bomnal: { id: 'aewol_bomnal', name: 'ë´„ë‚ ì¹´í˜', rating: 4.2, reviewCount: 2980, cost: 30000, type: 'cafe', icon: 'ğŸ¶', lat: 33.4639, lng: 126.3110, tags: ['ì˜¤ì…˜ë·°', 'ì›°ì‹œì½”ê¸°'], menu: [{item:'ë´„ë‚ ë¼ë–¼',price:7000},{item:'ì²œí˜œí–¥ì£¼ìŠ¤',price:8000}], reviews: [{author:'ê°ì„±ì—¬í–‰', rating:4, text:'ì•„ê¸°ìê¸°í•˜ê³  ì˜ˆìœ ì¹´í˜. ë°”ë‹¤ ë°”ë¡œ ì•ì´ë¼ íŒŒë„ì†Œë¦¬ ë“£ê¸° ì¢‹ì•„ìš”.'}] },
    randys_donuts: { id: 'randys_donuts', name: 'ëœë””ìŠ¤ë„ë„› ì• ì›”', rating: 4.3, reviewCount: 4211, cost: 25000, type: 'cafe', icon: 'ğŸ©', lat: 33.4631, lng: 126.3189, tags: ['ë„ë„›', 'ë””ì €íŠ¸', 'ì›¨ì´íŒ…'], menu: [{item:'ë²„í„°í¬ë¦¼ë„ë„›',price:3300},{item:'ê¸€ë ˆì´ì¦ˆ',price:2500}], reviews: [{author:'ë‹¬ë‹¬êµ¬ë¦¬', rating:4, text:'ì¢…ë¥˜ ë§ê³  ë§›ìˆì§€ë§Œ ì›¨ì´íŒ…ì€ ê°ì˜¤í•´ì•¼ í•´ìš”.'}] },
    myeongwol_school: { id: 'myeongwol_school', name: 'ëª…ì›”êµ­ë¯¼í•™êµ', rating: 4.3, reviewCount: 1621, cost: 30000, type: 'cafe', icon: 'ğŸ«', lat: 33.3986, lng: 126.2750, tags: ['ë ˆíŠ¸ë¡œ', 'ê°¤ëŸ¬ë¦¬', 'í¬í† ì¡´'], menu: [{item:'ì…ì¥ë£Œ(ìŒë£Œí¬í•¨)',price:8000}], reviews: [{author:'ì‚¬ì§„ì°ê¸°', rating:4, text:'ì‚¬ì§„ ì°ì„ ê³³ì´ ì •ë§ ë§ê³  ì»¨ì…‰ì´ ë…íŠ¹í•´ì„œ ì¢‹ì•˜ì–´ìš”.'}] },
    ultramarine: { id: 'ultramarine', name: 'ìš¸íŠ¸ë¼ë§ˆë¦°', rating: 4.4, reviewCount: 780, cost: 30000, type: 'cafe', icon: 'ğŸŒŠ', lat: 33.3615, lng: 126.1730, tags: ['í†µìœ ë¦¬', 'ì‹ ì°½í’ì°¨ë·°'], menu:[{item:'ì•„ë©”ë¦¬ì¹´ë…¸',price:6500},{item:'íŒ¨ì…˜í›„ë¥´ì¸ ì—ì´ë“œ',price:8000}], reviews: [{author:'ë·°ê¹¡íŒ¨', rating:5, text:'í†µìœ ë¦¬ì°½ìœ¼ë¡œ ë³´ì´ëŠ” ë°”ë‹¤ì™€ í’ì°¨ë·°ê°€ í™˜ìƒì ì´ì—ìš”.'}] },
    aewol_arte: { id: 'aewol_arte', name: 'ì•„ë¥´ë–¼ë®¤ì§€ì—„', rating: 4.7, reviewCount: 5560, cost: 60000, type: 'activity', icon: 'ğŸŒŒ', lat: 33.4116, lng: 126.3314, tags: ['ë¯¸ë””ì–´ì•„íŠ¸', 'ì‹¤ë‚´', 'ì¸ìƒìƒ·'], menu: [{item:'ì„±ì¸',price:17000},{item:'ì²­ì†Œë…„',price:13000}], reviews: [{author:'ì˜ˆìˆ Lover', rating:5, text:'ì •ë§ í™˜ìƒì ì¸ ê²½í—˜ì´ì—ˆì–´ìš”. ëª¨ë“  ì „ì‹œê´€ì´ ê°ë™ì ì…ë‹ˆë‹¤. ê°•ë ¥ ì¶”ì²œ!'}] },
    hallim_park: { id: 'hallim_park', name: 'í•œë¦¼ê³µì›', rating: 4.5, reviewCount: 4328, cost: 50000, type: 'activity', icon: 'ğŸŒ´', lat: 33.3917, lng: 126.2369, tags: ['í…Œë§ˆíŒŒí¬', 'ì‹ë¬¼ì›'], menu: [{item:'ì„±ì¸',price:15000},{item:'ì²­ì†Œë…„',price:10000}], reviews: [{author:'ê°€ì¡±ëŒ€í‘œ', rating:5, text:'ë³¼ê±°ë¦¬ê°€ ì •ë§ ë§ì•„ìš”. ì•¼ììˆ˜ê¸¸, ë™êµ´, ë¯¼ì†ì´Œê¹Œì§€ í•˜ë£¨ ì¢…ì¼ ë†€ ìˆ˜ ìˆì–´ìš”.'}] },
    hyeopjae_beach: { id: 'hyeopjae_beach', name: 'í˜‘ì¬í•´ìˆ˜ìš•ì¥', rating: 4.6, reviewCount: 3105, cost: 10000, type: 'activity', icon: 'ğŸ–ï¸', lat: 33.3937, lng: 126.2396, tags: ['ì—ë©”ë„ë“œë°”ë‹¤', 'ë¹„ì–‘ë„'], menu:[{item:'íŒŒë¼ì†”',price:10000},{item:'ìƒ¤ì›Œì¥',price:2000}], reviews: [{author:'ë¬¼ë†€ì´ê´‘', rating:5, text:'ì œì£¼ì—ì„œ ê°€ì¥ ì•„ë¦„ë‹¤ìš´ ë°”ë‹¤ìƒ‰ì¸ ê²ƒ ê°™ì•„ìš”. ë¬¼ì´ ì–•ì•„ ì•„ì´ë‘ ë†€ê¸° ì¢‹ì•„ìš”.'}] },
    sinchang_windmill: { id: 'sinchang_windmill', name: 'ì‹ ì°½í’ì°¨í•´ì•ˆë„ë¡œ', rating: 4.6, reviewCount: 1560, cost: 0, type: 'activity', icon: 'ğŸŒ¬ï¸', lat: 33.3642, lng: 126.1738, tags: ['ë“œë¼ì´ë¸Œ', 'ë…¸ì„ëª…ì†Œ'], menu:[], reviews: [{author:'ë“œë¼ì´ë²„', rating:5, text:'í•´ì§ˆë…˜ì— ê°€ë©´ ì •ë§ í™˜ìƒì ì¸ í’ê²½ì„ ë³¼ ìˆ˜ ìˆì–´ìš”. ê°•ë ¥ ì¶”ì²œí•˜ëŠ” ë“œë¼ì´ë¸Œ ì½”ìŠ¤!'}] },
    chagwido_tour: { id: 'chagwido_tour', name: 'ì°¨ê·€ë„ ë°°ë‚šì‹œ/ìš”íŠ¸', rating: 4.5, reviewCount: 500, cost: 80000, type: 'activity', icon: 'ğŸ›¥ï¸', lat: 33.3082, lng: 126.1633, tags: ['ë°°ë‚šì‹œ', 'ì´ìƒ‰ì²´í—˜'], menu:[{item:'ë°°ë‚šì‹œ(1ì¸)',price:20000}], reviews: [{author:'ê°•íƒœê³µ', rating:4, text:'ì´ˆë³´ìë„ ì‰½ê²Œ ì¦ê¸¸ ìˆ˜ ìˆê³ , ì¡ì€ ê³ ê¸°ëŠ” ì¦‰ì„ì—ì„œ íšŒë¡œ ë¨¹ì„ ìˆ˜ ìˆì–´ìš”.'}] },
    seogwipo_stay: { id: 'seogwipo_stay', name: 'ì„œê·€í¬ ì‹œë‚´ ìˆ™ì†Œ', cost: 170000, type: 'accommodation', tags: ['ìˆ™ì†Œ'], lat: 33.2476, lng: 126.5615 },
    sanbangsan: { id: 'sanbangsan', name: 'ì‚°ë°©ì‚°&ìš©ë¨¸ë¦¬í•´ì•ˆ', rating: 4.5, reviewCount: 1980, cost: 10000, type: 'activity', icon: 'â›°ï¸', lat: 33.2423, lng: 126.3138, tags: ['ì ˆê²½', 'ì§€ì§ˆíƒë°©'], menu:[{item:'í†µí•©ê¶Œ',price:2500}], reviews: [{author:'íƒí—˜ê°€', rating:5, text:'ë‹¤ë¥¸ í–‰ì„±ì— ì˜¨ ë“¯í•œ ëŠë‚Œ. íŒŒë„ì™€ ë°”ëŒì´ ë§Œë“  ìµœê³ ì˜ ì˜ˆìˆ ì‘í’ˆ!'}] },
    camellia_hill: { id: 'camellia_hill', name: 'ì¹´ë©œë¦¬ì•„í', rating: 4.3, reviewCount: 5120, cost: 40000, type: 'activity', icon: 'ğŸŒº', lat: 33.2913, lng: 126.3688, tags: ['ìˆ˜ëª©ì›', 'ê½ƒêµ¬ê²½', 'í¬í† ìŠ¤íŒŸ'], menu: [{item:'ì„±ì¸',price:10000},{item:'ì²­ì†Œë…„',price:8000}], reviews: [{author:'ê½ƒë³´ë‹¤ë‚˜', rating:4, text:'ê³„ì ˆë§ˆë‹¤ ë‹¤ë¥¸ ê½ƒì„ ë³¼ ìˆ˜ ìˆì–´ì„œ ì¢‹ì•„ìš”. ì‚¬ì§„ ì°ì„ ê³³ì´ ì •ë§ ë§ì•„ìš”.'}] },
    jusangjeolli: { id: 'jusangjeolli', name: 'ì£¼ìƒì ˆë¦¬ëŒ€', rating: 4.4, reviewCount: 3100, cost: 8000, type: 'activity', icon: 'ğŸ›ï¸', lat: 33.2378, lng: 126.4257, tags: ['ìì—°ê²½ê´€', 'ì¤‘ë¬¸'], menu:[{item:'ì„±ì¸',price:2000}], reviews: [{author:'ìì—°ì¸', rating:5, text:'ìì—°ì˜ ìœ„ëŒ€í•¨ì„ ëŠë‚„ ìˆ˜ ìˆëŠ” ê³³. íŒŒë„ê°€ ë¶€ë”ªíˆëŠ” ëª¨ìŠµì´ ì¥ê´€.'}] },
    cheonjeyeon_falls: { id: 'cheonjeyeon_falls', name: 'ì²œì œì—°í­í¬', rating: 4.4, reviewCount: 2150, cost: 10000, type: 'activity', icon: 'ğŸï¸', lat: 33.2511, lng: 126.4170, tags: ['í­í¬', 'ì‚°ì±…ë¡œ', 'ì„ ì„êµ'], menu: [{item:'ì„±ì¸',price:2500}], reviews: [{author:'ëšœë²…ì´', rating:4, text:'1, 2, 3í­í¬ ë‹¤ ë³´ëŠ” ì¬ë¯¸ê°€ ìˆì–´ìš”. ì‚°ì±…í•˜ê¸° ì •ë§ ì¢‹ì€ ê³³.'}] },
    olle_market: { id: 'olle_market', name: 'ì„œê·€í¬ë§¤ì¼ì˜¬ë ˆì‹œì¥', rating: 4.3, reviewCount: 9870, cost: 50000, type: 'food', icon: 'ğŸ¢', lat: 33.2498, lng: 126.5612, tags: ['ì‹œì¥', 'ê¸¸ê±°ë¦¬ìŒì‹'], menu: [{item:'í‘ë¼ì§€ê¼¬ì¹˜',price:6000},{item:'ë§ˆë†ì¹˜í‚¨',price:20000}], reviews: [{author:'ë¨¹ë°©ëŸ¬', rating:5, text:'ë¨¹ê±°ë¦¬ ì²œêµ­! ì €ë…ì— ê°€ì„œ í‘ë¼ì§€ê¼¬ì¹˜ë‘ ë§ˆë†ì¹˜í‚¨ì— ë§¥ì£¼ í•œì”í•˜ë©´ ìµœê³ ì˜ˆìš”.'}] },
    osulloc: { id: 'osulloc', name: 'ì˜¤ì„¤ë¡ í‹° ë®¤ì§€ì—„', rating: 4.4, reviewCount: 8910, cost: 40000, type: 'cafe', icon: 'ğŸµ', lat: 33.3059, lng: 126.2894, tags: ['ë…¹ì°¨ë°­', 'ì‹¤ë‚´', 'ë””ì €íŠ¸'], menu: [{item:'ë…¹ì°¨ì•„ì´ìŠ¤í¬ë¦¼',price:5500},{item:'ê·¸ë¦°í‹°ë¡¤ì¼€ìµ',price:6000}], reviews: [{author:'ë…¹ì°¨ë•í›„', rating:5, text:'ë…¹ì°¨ë°­ ë°°ê²½ìœ¼ë¡œ ì¸ìƒìƒ·ì€ í•„ìˆ˜! ì•„ì´ìŠ¤í¬ë¦¼ì´ë‘ ë¡¤ì¼€ìµì€ ê¼­ ë“œì„¸ìš”.'}] },
    the_cliff: { id: 'the_cliff', name: 'ë”í´ë¦¬í”„', rating: 4.3, reviewCount: 1200, cost: 50000, type: 'cafe', icon: 'ğŸ¹', lat: 33.2458, lng: 126.4103, tags: ['í´ëŸ½ë¶„ìœ„ê¸°', 'ì„ ì…‹', 'ì¤‘ë¬¸'], menu: [{item:'í´ë¦¬í”„ì„ ì…‹ì¹µí…Œì¼',price:15000},{item:'í”¼ì',price:28000}], reviews: [{author:'í™ìŠ¤í„°', rating:4, text:'í•´ì§ˆë…˜ í™í•œ ìŒì•…ê³¼ í•¨ê»˜ ì„ ì…‹ì„ ì¦ê¸°ê¸° ìµœê³ ì˜ ì¥ì†Œ.'}] },
    suksukdo: { id: 'suksukdo', name: 'ìˆ™ì„±ë„ ì¤‘ë¬¸ì ', rating: 4.5, reviewCount: 1900, cost: 120000, type: 'food', icon: 'ğŸ–', lat: 33.2541, lng: 126.4258, tags: ['ìˆ™ì„±í‘ë¼ì§€', 'ì›¨ì´íŒ…'], menu: [{item:'720ìˆ™ì„± í‘ëª©ì‚´',price:21000},{item:'ë™ì¹˜ë¯¸ì—´ë¬´êµ­ìˆ˜',price:8000}], reviews: [{author:'ë¯¸ì‹ê°€', rating:5, text:'ìˆ™ì„±ë¼ì§€ê³ ê¸°ì˜ ëíŒì™•. ë¶€ë“œëŸ¬ì›€ê³¼ ìœ¡ì¦™ì´ ì°¨ì›ì´ ë‹¬ë¼ìš”.'}] },
    chunsimine: { id: 'chunsimine', name: 'ì¶˜ì‹¬ì´ë„¤ ë³¸ì ', rating: 4.2, reviewCount: 2100, cost: 100000, type: 'food', icon: 'ğŸŸ', lat: 33.2801, lng: 126.3456, tags: ['í†µê°ˆì¹˜êµ¬ì´', 'ê°€ì¡±ì‹ì‚¬'], menu: [{item:'í†µê°ˆì¹˜êµ¬ì´2ì¸',price:78000}], reviews: [{author:'ìƒì„ ë§¤ë‹ˆì•„', rating:4, text:'ì—„ì²­ë‚œ í¬ê¸°ì˜ í†µê°ˆì¹˜ ë¹„ì£¼ì–¼ì´ ì••ë„ì . ë¼ˆë¥¼ ë‹¤ ë°œë¼ì¤˜ì„œ ë¨¹ê¸° í¸í•´ìš”.'}] },
    negeori_sikdang: { id: 'negeori_sikdang', name: 'ë„¤ê±°ë¦¬ì‹ë‹¹', rating: 4.1, reviewCount: 980, cost: 80000, type: 'food', icon: 'ğŸ²', lat: 33.2480, lng: 126.5601, tags: ['ê°ˆì¹˜êµ­', 'í–¥í† ìŒì‹'], menu:[{item:'ê°ˆì¹˜êµ­', price:15000},{item:'ê°ˆì¹˜ì¡°ë¦¼(ì†Œ)',price:40000}], reviews: [{author:'êµ­ë¬¼íŒŒ', rating:4, text:'ë¹„ë¦´ ê²ƒ ê°™ì§€ë§Œ ì „í˜€ ì•ˆ ë¹„ë¦¬ê³  ì‹œì›í•œ ê°ˆì¹˜êµ­ì´ ì¼í’ˆì´ì—ìš”.'}] },
    seongsan_ilchulbong: { id: 'seongsan_ilchulbong', name: 'ì„±ì‚°ì¼ì¶œë´‰', rating: 4.5, reviewCount: 15247, cost: 20000, type: 'activity', icon: 'ğŸŒ‹', lat: 33.4581, lng: 126.9426, tags: ['ìœ ë„¤ìŠ¤ì½”', 'ì¼ì¶œ'], menu: [{item:'ì„±ì¸',price:5000}], reviews: [{author:'ë“±ë°˜ê°€', rating:5, text:'í˜ë“¤ê²Œ ì˜¬ë¼ê°„ ë³´ëŒì´ ìˆëŠ” ë·°. ì œì£¼ì— ì™”ë‹¤ë©´ ê¼­ ê°€ë´ì•¼ í•  ê³³.'}] },
    udo_island: { id: 'udo_island', name: 'ìš°ë„', rating: 4.6, reviewCount: 7850, cost: 80000, type: 'activity', icon: 'ğŸï¸', lat: 33.5000, lng: 126.9500, tags: ['ì„¬ì†ì˜ì„¬', 'ìì „ê±°'], menu: [{item:'ì™•ë³µì„ ë°•',price:10500},{item:'ë•…ì½©ì•„ì´ìŠ¤í¬ë¦¼',price:5000}], reviews: [{author:'ì„¬ì—¬í–‰ì', rating:5, text:'ë°˜ë‚˜ì ˆ ì½”ìŠ¤ë¡œ ì™„ë²½í•´ìš”. ì „ê¸°ì°¨ íƒ€ê³  í•´ì•ˆë„ë¡œ ëŒë©´ ì •ë§ ì¢‹ì•„ìš”.'}] },
    seopjikoji: { id: 'seopjikoji', name: 'ì„­ì§€ì½”ì§€', rating: 4.4, reviewCount: 4590, cost: 0, type: 'activity', icon: 'ğŸï¸', lat: 33.4243, lng: 126.9295, tags: ['í•´ì•ˆì ˆê²½', 'ì‚°ì±…ë¡œ'], menu:[{item:'ì£¼ì°¨ë£Œ',price:3000}], reviews: [{author:'ì‚°ì±…ì™•', rating:4, text:'ë°”ë‹¤ì™€ ì–´ìš°ëŸ¬ì§„ í’ê²½ì´ ì˜ˆìˆ ì´ì—ìš”. ì²œì²œíˆ ê±·ê¸° ì¢‹ìŠµë‹ˆë‹¤.'}] },
    bijarim: { id: 'bijarim', name: 'ë¹„ìë¦¼', rating: 4.7, reviewCount: 3500, cost: 12000, type: 'activity', icon: 'ğŸŒ³', lat: 33.4903, lng: 126.8105, tags: ['ìˆ²ê¸¸', 'í”¼í†¤ì¹˜ë“œ', 'íë§'], menu: [{item:'ì„±ì¸',price:3000}], reviews: [{author:'ìì—°ì¸', rating:5, text:'ì²œë…„ì˜ ìˆ²ê¸¸ì„ ê±·ê¸°ë§Œ í•´ë„ íë§ë˜ëŠ” ìµœê³ ì˜ ì¥ì†Œ.'}] },
    sehwa_beach: { id: 'sehwa_beach', name: 'ì„¸í™”í•´ë³€', rating: 4.5, reviewCount: 1300, cost: 0, type: 'activity', icon: 'ğŸ–ï¸', lat: 33.5415, lng: 126.8576, tags: ['ì¹´í˜ê±°ë¦¬', 'ì—ë©”ë„ë“œë¹›'], menu:[], reviews: [{author:'ê°ì„±ì‚¬ì§„', rating:4, text:'ì˜ì í¬í† ì¡´ì´ ìœ ëª…í•´ìš”. ë°”ë‹¤ìƒ‰ì´ ì •ë§ ì˜ˆë»ìš”.'}] },
    myeongjin_jeonbok: { id: 'myeongjin_jeonbok', name: 'ëª…ì§„ì „ë³µ', rating: 4.3, reviewCount: 2890, cost: 70000, type: 'food', icon: 'ğŸš', lat: 33.5485, lng: 126.8533, tags: ['ì „ë³µëŒì†¥ë°¥', 'ì›¨ì´íŒ…'], menu: [{item:'ì „ë³µëŒì†¥ë°¥',price:16000},{item:'ì „ë³µêµ¬ì´',price:30000}], reviews: [{author:'ë°¥ë„ë‘‘', rating:5, text:'ê³ ì†Œí•œ ì „ë³µ ë‚´ì¥ë°¥ì€ ìŠì„ ìˆ˜ ì—†ëŠ” ë§›. ì›¨ì´íŒ…ì´ ê¸¸ì–´ë„ ê¸°ë‹¤ë ¤ì„œ ë¨¹ì–´ì•¼ í•´ìš”.'}] },
    gasiabang: { id: 'gasiabang', name: 'ê°€ì‹œì•„ë°©êµ­ìˆ˜', rating: 4.2, reviewCount: 2500, cost: 40000, type: 'food', icon: 'ğŸœ', lat: 33.4284, lng: 126.8839, tags: ['ê³ ê¸°êµ­ìˆ˜', 'ë”ë² ê³ ê¸°'], menu: [{item:'ê³ ê¸°êµ­ìˆ˜',price:9000},{item:'ë”ë² ê³ ê¸°(ì†Œ)',price:30000}], reviews: [{author:'êµ­ìˆ˜ë§¤ë‹ˆì•„', rating:4, text:'ìë§¤êµ­ìˆ˜ì™€ëŠ” ë˜ ë‹¤ë¥¸ ë§¤ë ¥. ë”ë² ê³ ê¸°ë„ ë¶€ë“œëŸ¬ì›Œìš”.'}] },
    mwolhandang: { id: 'mwolhandang', name: 'ë§Œì›”ë‹¹', rating: 4.5, reviewCount: 990, cost: 60000, type: 'food', icon: 'ğŸ', lat: 33.5492, lng: 126.7909, tags: ['ì „ë³µë¦¬ì¡°ë˜', 'ê°ì„±ë§›ì§‘'], menu: [{item:'ì „ë³µë¦¬ì¡°ë˜',price:21000},{item:'ëŒë¬¸ì–´íŒŒìŠ¤íƒ€',price:20000}], reviews: [{author:'ì–‘ì‹ëŸ¬ë²„', rating:5, text:'ë¶„ìœ„ê¸°ë„ ì¢‹ê³  ìŒì‹ë„ ì •ë§ ë§›ìˆì–´ìš”. íŠ¹íˆ ì „ë³µë¦¬ì¡°ë˜ ì¶”ì²œ!'}] },
    orda_cafe: { id: 'orda_cafe', name: 'ì¹´í˜ ì˜¤ë¥´ë‹¤', rating: 4.2, reviewCount: 1856, cost: 35000, type: 'cafe', icon: 'â˜•', lat: 33.4475, lng: 126.9323, tags: ['ì²œêµ­ì˜ê³„ë‹¨', 'ì„±ì‚°ë·°'], menu: [{item:'ì•„ë©”ë¦¬ì¹´ë…¸',price:7000},{item:'ì˜¤ë¥´ë‹¤ë¼ë–¼',price:8500}], reviews: [{author:'ì¸ìƒìƒ·', rating:4, text:'ì²œêµ­ì˜ê³„ë‹¨ì—ì„œ ì‚¬ì§„ ì°ìœ¼ë ¤ë©´ ì¤„ ì„œì•¼í•´ìš”. ì„±ì‚°ì¼ì¶œë´‰ ë·°ê°€ ì •ë§ ë©‹ì§‘ë‹ˆë‹¤.'}] },
    moumoon_cafe: { id: 'moumoon_cafe', name: 'ì¹´í˜ ëª¨ì•Œë³´ì•Œ', rating: 4.4, reviewCount: 950, cost: 30000, type: 'cafe', icon: 'â˜•', lat: 33.5407, lng: 126.8569, tags: ['ì„¸í™”í•´ë³€ë·°', 'ë£¨í”„íƒ‘'], menu: [{item:'ì•„ë©”ë¦¬ì¹´ë…¸',price:6000},{item:'ë‹¹ê·¼ì¼€ì´í¬',price:7000}], reviews: [{author:'ë°”ë‹¤ë©', rating:5, text:'ì„¸í™”ë°”ë‹¤ë¥¼ ì •ë©´ìœ¼ë¡œ ë³´ë©° ì»¤í”¼ ë§ˆì‹œê¸° ì¢‹ì•„ìš”. ë£¨í”„íƒ‘ì´ ìµœê³ !'}] }
};
const itineraryData = {
    day1: { title: "1ì¼ì°¨: ê³µí•­ ë„ì°© & ì œì£¼ì‹œë‚´ ë§›ë³´ê¸°", options: [
        { time: '16:00', icon: 'âœˆï¸', category: 'ê³µí•­ ë„ì°© ë° ë ŒíŠ¸ì¹´', places: ['arrival'] },
        { time: '18:00', icon: 'ğŸ´', category: 'ì €ë… ì‹ì‚¬ (ê³µí•­ ê·¼ì²˜)', places: ['dombedon', 'jamaeguksu', 'samsunghyeol', 'ujin_haejang', 'dongmun_market'] },
        { time: '20:00', icon: 'ğŸŒ™', category: 'ì•¼ê°„ í™œë™ (ê³µí•­ ê·¼ì²˜)', places: ['dongmun_market', 'yongduam', 'iho_tewoo', 'abebe_bakery'] },
        { time: '21:30', icon: 'ğŸ¨', category: 'ìˆ™ì†Œ ì²´í¬ì¸ (ê³µí•­ ê·¼ì²˜)', places: ['airport_stay'] },
    ]},
    day2: { title: "2ì¼ì°¨: ë‚­ë§Œ ê°€ë“ ì„œìª½ í•´ì•ˆë„ë¡œ ì¼ì£¼", options: [
        { time: '09:30', icon: 'â˜•', category: 'ì•„ì¹¨ & ì¹´í˜ (ì• ì›”)', places: ['aewol_bomnal', 'aewol_monsant', 'randys_donuts', 'myeongwol_school', 'ultramarine'] },
        { time: '11:00', icon: 'ğŸï¸', category: 'ì˜¤ì „ í™œë™ (ì• ì›”/í•œë¦¼)', places: ['aewol_arte', 'hallim_park', 'hyeopjae_beach', 'sinchang_windmill', 'chagwido_tour'] },
        { time: '13:30', icon: 'ğŸ´', category: 'ì ì‹¬ ì‹ì‚¬ (ì• ì›”/í•œë¦¼)', places: ['aewol_noraba', 'hallim_suudong', 'aewol_dwaeji', 'jejidona', 'chagwido_budu'] },
        { time: '18:30', icon: 'ğŸ¨', category: 'ìˆ™ì†Œ ì²´í¬ì¸ (ì°¨ê·€ë„ ê·¼ì²˜)', places: ['chagwido_stay'] },
    ]},
    day3: { title: "3ì¼ì°¨: ê²½ì´ë¡œìš´ ìì—°, ì¤‘ë¬¸&ì„œê·€í¬", options: [
        { time: '09:30', icon: 'ğŸŒ¿', category: 'ì˜¤ì „ í™œë™ (ì•ˆë•/ì¤‘ë¬¸)', places: ['sanbangsan', 'camellia_hill', 'osulloc', 'jusangjeolli', 'cheonjeyeon_falls'] },
        { time: '13:00', icon: 'ğŸ´', category: 'ì ì‹¬ ì‹ì‚¬ (ì¤‘ë¬¸/ì•ˆë•)', places: ['suksukdo', 'chunsimine', 'the_cliff', 'negeori_sikdang'] },
        { time: '15:00', icon: 'ğŸš¶', category: 'ì˜¤í›„ í™œë™ (ì„œê·€í¬ ì‹œë‚´)', places: ['olle_market', 'jusangjeolli', 'cheonjeyeon_falls'] },
        { time: '18:30', icon: 'ğŸ¨', category: 'ì €ë… ë° ìˆ™ì†Œ (ì„œê·€í¬ ì‹œë‚´)', places: ['olle_market', 'negeori_sikdang', 'seogwipo_stay'] },
    ]},
    day4: { title: "4ì¼ì°¨: ëˆˆë¶€ì‹  ë™ìª½ í•´ì•ˆ & ê³µí•­ ë³µê·€", options: [
        { time: '10:00', icon: 'â›°ï¸', category: 'ì˜¤ì „ í™œë™ (ì„±ì‚°)', places: ['seongsan_ilchulbong', 'udo_island', 'seopjikoji', 'bijarim'] },
        { time: '13:00', icon: 'ğŸ´', category: 'ì ì‹¬ ì‹ì‚¬ (ì„±ì‚°/êµ¬ì¢Œ)', places: ['myeongjin_jeonbok', 'gasiabang', 'mwolhandang'] },
        { time: '15:00', icon: 'â˜•', category: 'ì˜¤í›„ í™œë™ (ì„¸í™”/ì†¡ë‹¹)', places: ['sehwa_beach', 'moumoon_cafe', 'orda_cafe', 'bijarim'] },
        { time: '17:00', icon: 'ğŸ›«', category: 'ê³µí•­ ì´ë™ ë° ì¶œë°œ', places: ['arrival'] },
    ]}
};

// Global variables
let googleMap, placesService, directionsService, directionsRenderer;
let activeDay = 1;
let selections = {};
let infoWindows = [];
let themeMarkers = [];

// App Initialization
function initApp() {
    initUI();
    initMapAndServices();
    setupInitialState();
    setupEventListeners();
}

// *** BUG FIX & IMPROVEMENT: initUI is now idempotent and corrected ***
function initUI() {
    const tabsContainer = document.getElementById('day-tabs-container');
    const itineraryContainer = document.getElementById('itinerary-container');
    
    // Clear containers to prevent duplication on any potential re-runs
    tabsContainer.innerHTML = '';
    itineraryContainer.innerHTML = ''; 

    Object.keys(itineraryData).forEach((dayKey, index) => {
        const day = parseInt(dayKey.replace('day', ''));
        const dayData = itineraryData[dayKey];

        // Create Day Tab
        const tab = document.createElement('button');
        tab.className = `day-tab py-3 px-4 md:px-6 text-sm md:text-base font-semibold text-gray-500 ${index === 0 ? 'active' : ''}`;
        tab.textContent = `${day}ì¼ì°¨`;
        tab.dataset.day = day;
        tab.onclick = () => switchDay(day);
        tabsContainer.appendChild(tab);

        // Create Day Content
        const dayContent = document.createElement('div');
        dayContent.id = `day${day}-content`;
        dayContent.className = `day-content ${index > 0 ? 'hidden' : ''}`;
        dayContent.innerHTML = `
            <div class="bg-white rounded-xl shadow-lg p-4 md:p-6 mb-6">
                <h2 class="text-2xl font-black text-gray-800 mb-6">${dayData.title}</h2>
                ${dayData.options.map(slot => `
                    <div class="mb-8">
                        <div class="flex items-center mb-4">
                            <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-semibold mr-4">${slot.time}</span>
                            <h3 class="text-lg md:text-xl font-bold text-gray-800">${slot.icon} ${slot.category}</h3>
                        </div>
                        <div class="space-y-2" data-day="${day}" data-time="${slot.time}">
                            ${slot.places.map(placeId => generateOptionHtml(day, slot.time, placeId)).join('')}
                        </div>
                    </div>
                `).join('')}
            </div>
        `;
        itineraryContainer.appendChild(dayContent);
    });
    
    // Cost Calculator
    document.getElementById('cost-calculator').innerHTML = `
        <div>
            <h4 class="font-semibold text-gray-700 mb-3">âœˆï¸ í•­ê³µë£Œ & ğŸ¨ ìˆ™ë°•ë¹„</h4>
            <div class="grid grid-cols-2 gap-3">
                <div><label class="block text-sm text-gray-600 mb-1">í•­ê³µë£Œ(4ì¸)</label><input type="number" id="flight-cost" class="w-full p-2 border rounded-lg text-right" placeholder="0" step="10000"></div>
                <div><label class="block text-sm text-gray-600 mb-1">ìˆ™ë°•ë¹„(3ë°•)</label><input type="number" id="hotel-cost" class="w-full p-2 border rounded-lg text-right" placeholder="0" step="10000"></div>
            </div>
        </div>
        <div class="border-t pt-4">
            <h4 class="font-semibold text-gray-700 mb-3">ğŸï¸ í˜„ì§€ ì—¬í–‰ ê²½ë¹„</h4>
            <div class="space-y-2">
                <div class="flex justify-between"><span class="text-gray-600">ğŸ´ ì‹ë¹„</span><span class="font-semibold" id="cost-food">â‚©0</span></div>
                <div class="flex justify-between"><span class="text-gray-600">ğŸŸï¸ ì²´í—˜/ì…ì¥ë£Œ</span><span class="font-semibold" id="cost-activity">â‚©0</span></div>
                <div class="flex justify-between"><span class="text-gray-600">â˜• ê¸°íƒ€</span><span class="font-semibold" id="cost-etc">â‚©0</span></div>
            </div>
        </div>
        <div class="border-t-2 pt-4">
            <div class="text-center bg-gradient-to-r from-blue-50 to-purple-50 p-4 rounded-lg">
                <p class="text-sm text-gray-600 mb-1">ì´ ì˜ˆìƒ ì—¬í–‰ ê²½ë¹„</p>
                <p class="text-3xl font-bold text-blue-600" id="total-cost">â‚©0</p>
            </div>
        </div>
    `;
}

function generateOptionHtml(day, time, placeId) {
    const place = jejuDatabase[placeId];
    if (!place) return '';
    return `
        <div class="option-container" data-id="${place.id}">
            <button class="option-bar" data-day="${day}" data-time="${time}" onclick="handleOptionSelect(this)">
                <span class="option-icon">${place.icon || 'ğŸ“'}</span>
                <span class="option-name">${place.name}</span>
                ${place.rating ? `<span class="rating-box"><i class="fas fa-star text-xs mr-1"></i> ${place.rating}</span>` : ''}
            </button>
            <div class="details-panel">
                <!-- Details will be loaded here on first click -->
            </div>
        </div>
    `;
}

function handleOptionSelect(buttonElement) {
    const day = buttonElement.dataset.day;
    const time = buttonElement.dataset.time;
    const container = buttonElement.closest('.option-container');
    const placeId = container.dataset.id;
    const detailsPanel = container.querySelector('.details-panel');
    const isSelected = buttonElement.classList.contains('selected');

    const timeSlotContainer = buttonElement.closest('[data-day][data-time]');
    timeSlotContainer.querySelectorAll('.option-bar.selected').forEach(bar => {
        if (bar !== buttonElement) {
            bar.classList.remove('selected');
            bar.closest('.option-container').querySelector('.details-panel').classList.remove('open');
        }
    });

    buttonElement.classList.toggle('selected');
    detailsPanel.classList.toggle('open');
    
    if (!isSelected) {
        selections[day][time] = jejuDatabase[placeId];
        // Populate details panel only on first open
        if (detailsPanel.innerHTML.trim().startsWith('<!--')) {
            detailsPanel.innerHTML = generateDetailsPanelContent(jejuDatabase[placeId]);
            setupDetailsTabs(detailsPanel);
        }
    } else {
        delete selections[day][time];
    }
    updateAllDisplays();
}

function generateDetailsPanelContent(place) {
    const hasMenu = place.menu && place.menu.length > 0;
    const hasReviews = place.reviews && place.reviews.length > 0;
    return `
        <div class="details-tabs">
            ${hasMenu ? `<button class="details-tab active" data-tab="menu">ëŒ€í‘œ ë©”ë‰´</button>` : ''}
            ${hasReviews ? `<button class="details-tab ${!hasMenu ? 'active' : ''}" data-tab="reviews">ë¦¬ë·° ìš”ì•½</button>` : ''}
        </div>
        <div class="details-content ${hasMenu ? 'active' : ''}" data-content="menu">
            ${hasMenu ? place.menu.map(item => `
                <div class="flex justify-between items-center py-2 border-b border-gray-200"><span class="font-semibold text-gray-700">${item.item}</span><span class="font-bold text-blue-600">â‚©${item.price.toLocaleString()}</span></div>
            `).join('') : '<p class="text-gray-500">ë©”ë‰´ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>'}
        </div>
        <div class="details-content ${!hasMenu && hasReviews ? 'active' : ''}" data-content="reviews">
            ${hasReviews ? place.reviews.map(review => `
                <div class="border-b border-gray-200 pb-3 mb-3">
                    <div class="flex justify-between items-center mb-1"><span class="font-semibold text-gray-800">${review.author}</span><div class="rating-box text-sm">${'â˜…'.repeat(review.rating)}${'â˜†'.repeat(5-review.rating)}</div></div>
                    <p class="text-gray-700 text-sm">"${review.text}"</p>
                </div>
            `).join('') : '<p class="text-gray-500">ë¦¬ë·° ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</p>'}
        </div>
    `;
}

function setupDetailsTabs(panel) {
    const tabs = panel.querySelectorAll('.details-tab');
    const contents = panel.querySelectorAll('.details-content');
    tabs.forEach(tab => {
        tab.addEventListener('click', () => {
            tabs.forEach(t => t.classList.remove('active'));
            contents.forEach(c => c.classList.remove('active'));
            tab.classList.add('active');
            panel.querySelector(`[data-content="${tab.dataset.tab}"]`).classList.add('active');
        });
    });
}

function initMapAndServices() {
    googleMap = new google.maps.Map(document.getElementById('map'), { center: { lat: 33.385, lng: 126.55 }, zoom: 9, disableDefaultUI: true, zoomControl: true, mapTypeControl: false, streetViewControl: false });
    placesService = new google.maps.places.PlacesService(googleMap);
    directionsService = new google.maps.DirectionsService();
    directionsRenderer = new google.maps.DirectionsRenderer({ suppressMarkers: true, polylineOptions: { strokeColor: '#4f46e5', strokeWeight: 5, strokeOpacity: 0.8 } });
    directionsRenderer.setMap(googleMap);
}

function setupInitialState() {
    Object.keys(itineraryData).forEach(dayKey => {
        const day = parseInt(dayKey.replace('day', ''));
        selections[day] = {};
        itineraryData[dayKey].options.forEach(slot => {
            const placeId = slot.places[0];
            selections[day][slot.time] = jejuDatabase[placeId];
            const button = document.querySelector(`.option-container[data-id="${placeId}"] .option-bar[data-day="${day}"][data-time="${slot.time}"]`);
            if(button) button.classList.add('selected');
        });
    });
    updateAllDisplays();
}

function setupEventListeners() {
    document.getElementById('cost-calculator').addEventListener('input', e => { updateCostDisplay(); });
    
    const bottomNav = document.getElementById('bottom-nav');
    window.addEventListener('scroll', () => {
        if (window.scrollY + window.innerHeight >= document.body.scrollHeight - 100) {
            bottomNav.classList.add('visible');
        } else {
            bottomNav.classList.remove('visible');
        }
    }, { passive: true });

    document.getElementById('prev-day-btn').onclick = () => { if (activeDay > 1) switchDay(activeDay - 1); };
    document.getElementById('next-day-btn').onclick = () => { if (activeDay < Object.keys(itineraryData).length) switchDay(activeDay + 1); };
}

function switchDay(day) {
    activeDay = day;

    // Update active tab
    document.querySelectorAll('.day-tab').forEach(tab => {
        tab.classList.toggle('active', tab.dataset.day == day);
    });

    // Show/hide day content
    document.querySelectorAll('.day-content').forEach(content => {
        content.classList.toggle('hidden', content.id !== `day${day}-content`);
    });

    // Update bottom nav
    document.getElementById('bottom-nav-day').textContent = day;
    document.getElementById('prev-day-btn').disabled = (day === 1);
    document.getElementById('next-day-btn').disabled = (day === Object.keys(itineraryData).length);

    updateAllDisplays();
}

function updateAllDisplays() {
    updateCostDisplay();
    updateSelectedItemsDisplay();
    updateMapForDay(activeDay);
}

function updateCostDisplay() {
    const costs = { food: 0, activity: 0, etc: 0 };
    let hotelCost = 0;
    Object.values(selections).forEach(daySels => {
        Object.values(daySels).forEach(sel => {
            if (!sel) return;
            const type = sel.type === 'cafe' ? 'etc' : sel.type;
            if (type === 'accommodation') hotelCost += sel.cost || 0;
            else if (costs.hasOwnProperty(type)) costs[type] += sel.cost || 0;
        });
    });
    
    document.getElementById('hotel-cost').value = hotelCost;
    const flightCost = parseInt(document.getElementById('flight-cost').value) || 0;
    
    document.getElementById('cost-food').textContent = `â‚©${costs.food.toLocaleString()}`;
    document.getElementById('cost-activity').textContent = `â‚©${costs.activity.toLocaleString()}`;
    document.getElementById('cost-etc').textContent = `â‚©${costs.etc.toLocaleString()}`;
    const total = costs.food + costs.activity + costs.etc + flightCost + hotelCost;
    document.getElementById('total-cost').textContent = `â‚©${total.toLocaleString()}`;
}

function updateSelectedItemsDisplay() {
    const container = document.getElementById('selected-items-container');
    const daySelections = selections[activeDay] || {};
    const sortedTimes = Object.keys(daySelections).sort();
    if (Object.keys(daySelections).filter(time => daySelections[time].type !== 'accommodation').length === 0) {
        container.innerHTML = '<p class="text-center text-gray-500 py-6">ì„ íƒëœ ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
        return;
    }
    container.innerHTML = `<div class="space-y-3">${sortedTimes.map(time => {
        const sel = daySelections[time];
        if (sel && sel.type !== 'accommodation') {
            return `<div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg"><div class="flex items-center"><span class="text-sm font-bold text-blue-600 w-12">${time}</span><span class="font-medium">${sel.name}</span></div><span class="text-sm font-bold">â‚©${(sel.cost||0).toLocaleString()}</span></div>`;
        } return '';
    }).join('')}</div>`;
}

function updateMapForDay(day) {
    if (!googleMap) return;
    const daySelections = Object.entries(selections[day] || {}).filter(([t, s]) => s && s.lat && s.lng).sort(([tA], [tB]) => tA.localeCompare(tB)).map(([t, s]) => s);
    
    clearMarkers();
    directionsRenderer.setDirections({routes: []});
    
    if (daySelections.length === 0) return;
    const bounds = new google.maps.LatLngBounds();
    daySelections.forEach((sel, index) => {
        const pos = { lat: sel.lat, lng: sel.lng };
        bounds.extend(pos);
        const marker = new google.maps.Marker({
            position: pos, map: googleMap, label: { text: `${index + 1}`, color: 'white', fontWeight: 'bold' },
            icon: { path: google.maps.SymbolPath.CIRCLE, scale: 15, fillColor: '#4f46e5', fillOpacity: 1, strokeColor: 'white', strokeWeight: 2 },
            title: sel.name
        });
        themeMarkers.push(marker);
    });
    if (daySelections.length > 1) {
        const request = {
            origin: { lat: daySelections[0].lat, lng: daySelections[0].lng },
            destination: { lat: daySelections[daySelections.length - 1].lat, lng: daySelections[daySelections.length - 1].lng },
            waypoints: daySelections.slice(1, -1).map(s => ({ location: { lat: s.lat, lng: s.lng } })),
            travelMode: google.maps.TravelMode.DRIVING
        };
        directionsService.route(request, (result, status) => { if (status === 'OK') directionsRenderer.setDirections(result); });
    }
    googleMap.fitBounds(bounds);
    if (googleMap.getZoom() > 15) googleMap.setZoom(15);
}

function clearMarkers() {
    themeMarkers.forEach(marker => marker.setMap(null));
    themeMarkers = [];
    infoWindows.forEach(infoWindow => infoWindow.close());
    infoWindows = [];
}

function searchByTheme(type) {
    const jejuBounds = { south: 33.1, west: 126.1, north: 33.6, east: 127.0 };
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(position => {
            const { latitude, longitude } = position.coords;
            if (latitude > jejuBounds.south && latitude < jejuBounds.north && longitude > jejuBounds.west && longitude < jejuBounds.east) {
                if (confirm("í˜„ì¬ ìœ„ì¹˜ ê·¼ì²˜(10km)ì—ì„œ ê²€ìƒ‰í• ê¹Œìš”?")) {
                    executePlaceSearch(type, { lat: latitude, lng: longitude }, 10000);
                    return;
                }
            }
            executePlaceSearch(type, { lat: 33.385, lng: 126.55 }, 30000);
        }, () => {
             executePlaceSearch(type, { lat: 33.385, lng: 126.55 }, 30000);
        });
    } else {
        executePlaceSearch(type, { lat: 33.385, lng: 126.55 }, 30000);
    }
}

function executePlaceSearch(type, location, radius) {
    const keywordMap = { restaurant: 'ë§›ì§‘', cafe: 'ì¹´í˜', tourist_attraction: 'ê´€ê´‘ì§€', beach: 'í•´ìˆ˜ìš•ì¥', shopping: 'ì‡¼í•‘', activity: 'ì²´í—˜' };
    const request = {
        location: new google.maps.LatLng(location.lat, location.lng),
        radius: radius,
        keyword: `ì œì£¼ ${keywordMap[type]}`,
        language: 'ko'
    };
    placesService.nearbySearch(request, (results, status) => {
        if (status === google.maps.places.PlacesServiceStatus.OK && results) {
            clearMarkers();
            directionsRenderer.setDirections({routes: []}); // Clear route line as well
            const bounds = new google.maps.LatLngBounds();
            const filtered = results.filter(p => p.rating && p.rating >= 4.0).slice(0, 20);
            filtered.forEach(place => {
                const marker = new google.maps.Marker({ position: place.geometry.location, map: googleMap, title: place.name });
                bounds.extend(place.geometry.location);
                marker.addListener('click', () => showThemeInfoWindow(marker, place.place_id));
                themeMarkers.push(marker);
            });
            if (filtered.length > 0) {
                googleMap.fitBounds(bounds);
            } else {
                alert('í‰ì  4.0 ì´ìƒ ì¥ì†Œë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.');
            }
        } else {
            alert('ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.');
        }
    });
}

function showThemeInfoWindow(marker, placeId) {
    placesService.getDetails({
        placeId: placeId,
        fields: ['name', 'rating', 'user_ratings_total', 'reviews', 'price_level']
    }, (place, status) => {
        if (status === google.maps.places.PlacesServiceStatus.OK && place) {
            infoWindows.forEach(iw => iw.close());
            
            let priceText = '';
            if (place.price_level) priceText = 'â‚©'.repeat(place.price_level);
            
            let menuSummary = '<div class="text-gray-500 text-sm">ë©”ë‰´ ì •ë³´ ì—†ìŒ</div>';
            if (place.reviews) {
                const menuItems = new Set();
                const menuRegex = /(\p{L}+)(ê°ˆë¹„|êµ­ìˆ˜|í”¼ì|íŒŒìŠ¤íƒ€|ë²„ê±°|ì»¤í”¼|ë¼ë–¼|ì—ì´ë“œ|ì¼€ì´í¬|ë¹µ|íšŒ|ì¡°ë¦¼|êµ¬ì´|íƒ•)(?![ì„ë¥¼ì´ê°€ì€ëŠ”])/gu;
                place.reviews.forEach(review => {
                    const matches = review.text.match(menuRegex);
                    if (matches) matches.forEach(item => menuItems.add(item));
                });
                if (menuItems.size > 0) {
                    menuSummary = [...menuItems].slice(0,3).map(item => `<div class="menu-item"><span>${item}</span> <span>${priceText}</span></div>`).join('');
                }
            }

            const content = `
                <div class="info-window-content">
                    <h3>${place.name}</h3>
                    <div class="rating">
                        ${'â˜…'.repeat(Math.round(place.rating || 0))}${'â˜†'.repeat(5 - Math.round(place.rating || 0))}
                        <strong> ${place.rating || 'N/A'}</strong> (${place.user_ratings_total || 0}ê°œ)
                    </div>
                    <div class="menu-title">ëŒ€í‘œ ë©”ë‰´ (ë¦¬ë·° ê¸°ë°˜ ì¶”ì •)</div>
                    ${menuSummary}
                </div>`;
            const infoWindow = new google.maps.InfoWindow({ content: content });
            infoWindow.open(googleMap, marker);
            infoWindows.push(infoWindow);
        }
    });
}

// Ensure the app starts after Google Maps script is fully loaded
window.addEventListener('load', () => {
    if (typeof google === 'undefined' || typeof google.maps === 'undefined') {
        console.error("Google Maps script failed to load. Retrying...");
        setTimeout(initApp, 1500); 
    }
});
</script>
</body>
</html>
